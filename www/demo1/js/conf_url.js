function getinfo(){this.getId=function(e){return document.getElementById(e)},this.getClassName=function(e){return document.getElementsByClassName(e)},this.getTagName=function(e){return document.getElementsByTagName(e)},this.getNum=function(e){return this.getTagName(e).length-1},this.createTag=function(e){return document.createElement(e)},this.createText=function(e){return document.createTextNode(e)}}function modal(){$("#myModal").modal("show"),$(".send").attr("id","send1"),obj.getId("send1").onclick=sendInfo}function sendInfo(e){var t=obj.getId("url").value,n=obj.getId("cookie").value,a=obj.getId("hz").value,r=obj.getId("date").value,o=obj.getId("desc").value,d=n.match(/(.*?)=(.*?)($|;)/g),s=t.match(/^((https|http|ftp|rtsp|mms)?:\/\/)[^\s]+/);e||window.event;var l=e.scrElement?e.scrElement:e.target;if(""==t||""==r)alert("请填写必要的数据");else if(null==s)alert("请输入正确的URL");else if("none"!=obj.getId("cookies").style.display)if(null==d)alert("请输入正确的cookie格式");else if(""==a)alert("请输入频率值");else if(a=parseInt(a),arr=new Array(s[0],d,o,a+r,getDate()),obj.getClassName("send")[0].setAttribute("data-dismiss","modal"),$("#none").remove(),"send1"===l.id)ajaxadd(arr),createtr(),obj.getNum("tr")+1<=10&&(createtd(),createbut(arr),operation());else{console.log(arr);for(var i=["url","cookie","desc","hz"],c=0;c<i.length;++c)obj.getClassName(i[c])[id-1].innerHTML=arr[c]}else if("none"==obj.getId("cookies").style.display)if(""==a)alert("请输入频率值");else if(a=parseInt(a),arr=new Array(s[0],d,o,a+r,getDate()),obj.getClassName("send")[0].setAttribute("data-dismiss","modal"),$("#none").remove(),"send1"===l.id)ajaxadd(arr),createtr(),obj.getNum("tr")+1<=10&&(createtd(arr),createbut(),operation());else{console.log(arr);for(var i=["url","cookie","desc","hz"],c=0;c<i.length;++c)obj.getClassName(i[c])[id-1].innerHTML=arr[c]}}function display(){$("#cookies").toggle()}function getDate(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,a=e.getDay(),r=e.getHours(),o=e.getMinutes(),d=e.getSeconds();return d<10&&(d="0"+d),r<10&&(r="0"+r),n<10&&(n="0"+n),a<10&&(a="0"+a),o<10&&(o="0"+o),t+"-"+n+"-"+a+" "+r+":"+o+":"+d}function createtr(){var e=obj.getNum("tr");if(e+1>10)return void alert("URL配置仅能添加 10 条");obj.getClassName("num")[0].innerHTML="URL配置仅能添加 10 条，当前您已添加 "+(e+1)+"条。",tr=obj.createTag("tr"),obj.getTagName("tbody")[0].appendChild(tr)}function createtd(e){for(var t=["url","cookie","desc","hz","date"],n=0;n<e.length;++n){var a=obj.createTag("td");a.setAttribute("class",t[n]),tr.appendChild(a),a.innerHTML=e[n]}}function createbut(){var e=obj.createTag("td"),t=["编辑","删除"],n=["btn-default","btn-danger"],a=["input","del"],r=t.length;e.style.textAlign="center";for(var o=0;o<r;o++){var d=obj.createText(t[o]),s=obj.createTag("button");s.setAttribute("class","btn "+n[o]+" btn-xs "+a[o]),s.value=t[o],s.type="button",s.style.marginRight="4px",e.appendChild(s),s.appendChild(d)}tr.appendChild(e),e.style.border="1px solid #dddddd"}function operation(){for(var e=obj.getClassName("del"),t=obj.getClassName("input"),n=e.length,a=0;a<n;++a)t[a].onclick=change(a),e[a].onclick=delt(a)}function change(e){function t(e){$("#myModal").modal("show"),$(".send").attr("id","send");var t=e.srcElement?e.srcElement:e.target;id=t.parentElement.parentNode.rowIndex;for(var n=(obj.getTagName("tr")[id],["url","cookie","desc","hz"]),a=0;a<n.length;++a)obj.getId(n[a]).value=obj.getClassName(n[a])[id-1].innerHTML;obj.getId("send").onclick=sendInfo}return t}function delt(e){function t(e){if(window.confirm("你真的要删除吗？")){var t=e.srcElement?e.srcElement:e.target,n=document.getElementsByTagName("tr")[t.parentElement.parentNode.rowIndex];ajaxdese("./conf_url.php?url="+obj.getClassName("url")[t.parentElement.parentNode.rowIndex-1].innerHTML);document.getElementsByTagName("tbody")[0].removeChild(n);var a=obj.getNum("tr");obj.getClassName("num")[0].innerHTML="URL配置仅能添加 10 条，当前您已添加 "+a+"条。"}}return t}function ajaxadd(e){var t="url="+e[0]+"&cookie="+e[1]+"&desc="+e[2]+"&hzd="+e[3]+"&date="+e[4],n=new XMLHttpRequest;n.onreadystatechange=function(){4==n.readyState&&(console.log(n),alert(n.responseText))},n.open("post","./conf_url_insert.php"),n.setRequestHeader("content-type","application/x-www-form-urlencoded"),n.send(t)}function ajaxdese(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){4==t.readyState&&t.responseText},t.open("get",e),t.send()}function ajaxchange(){}var obj=new getinfo,arr=null;window.onload=function(){obj.getId("cookies").style.display="none",obj.getId("checkbox").onclick=display,obj.getId("key").onclick=modal};var tr;